sap.ui.define(["./BaseController","sap/ui/model/json/JSONModel","sap/m/Token","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/m/MessageBox","sap/ui/core/library","sap/ui/Device","sap/m/NotificationListItem","sap/m/MessageToast","sap/ui/model/odata/v2/ODataModel"],function(e,t,o,i,s,n,a,r,d,l){"use strict";var u=r.Priority;return e.extend("com.app.libraryapplication.controller.AllBooks",{onInit:function(){const e=this.getOwnerComponent().getRouter();e.attachRoutePatternMatched(this.onCurrentUserDetails,this);const t=this.getView(),o=t.byId("multiInput1"),i=t.byId("multiInput2"),s=t.byId("multiInput3"),n=t.byId("multiInput4");let a=function(e){if(true){var t=e.text;return new sap.m.Token({key:t,text:t})}};o.addValidator(a);i.addValidator(a);s.addValidator(a);n.addValidator(a)},onCurrentUserDetails:function(e){const{id:t}=e.getParameter("arguments");this.ID=t;const o=this.getView().byId("idBooksListPage");this.getView().byId("idBooksTable").getBinding("items").refresh();o.bindElement(`/Users(${t})`,{expand:""})},onGoPress:function(){const e=this.getView(),t=e.byId("multiInput1"),o=t.getTokens(),n=e.byId("multiInput2"),a=n.getTokens(),r=e.byId("multiInput3"),d=r.getTokens(),l=e.byId("multiInput4"),u=l.getTokens(),c=e.byId("idBooksTable"),g=[];o.forEach(e=>{if(e){g.push(new i("ISBN",s.EQ,e.getKey()))}});a.forEach(e=>{if(e){g.push(new i("title",s.EQ,e.getKey()))}});d.forEach(e=>{if(e){g.push(new i("author",s.EQ,e.getKey()))}});u.forEach(e=>{if(e){g.push(new i("genre",s.EQ,e.getKey()))}});c.getBinding("items").filter(g)},onClearFilterPress:function(){const e=this.getView(),t=e.byId("multiInput1"),o=e.byId("multiInput2"),i=e.byId("multiInput3"),s=e.byId("multiInput4"),n=e.byId("idBooksTable");t.destroyTokens();o.destroyTokens();i.destroyTokens();s.destroyTokens();n.getBinding("items").filter([])},onReserveBook:async function(e){var t=e.getSource();console.log(e.getSource().getParent());var o=this.ID;if(this.byId("idBooksTable").getSelectedItems().length>1){a.show("Please Select only one Book");return}var i=this.byId("idBooksTable").getSelectedItem().getBindingContext().getObject();const s=new sap.ui.model.json.JSONModel({userID_ID:o,bookID_ID:i.ID,resevedate:new Date});this.getView().setModel(s,"userModel");const r=this.getView().getModel("userModel").getProperty("/"),d=this.getView().getModel("ModelV2");try{await this.createData(d,r,"/Reservation");n.success("Book Reserved")}catch(e){n.error("Some technical Issue")}}})});